<% @title = @user.name + 'の短歌' %>

<div class = "vertical serif tanka-index mt-3">
  <div class="margin-right">
    <%= image_tag @user.avatar.url(:original), align: 'center' %>&nbsp;
    <span class="tanka-show"><%= @user.name %></span>&nbsp;
    <% if Rails.env == 'production' && @user.twitter_id.present? %>
      <a href="<%= 'https://twitter.com/intent/follow?screen_name='  + @user.twitter_id %>"><%= image_tag("http://utakata.s3.amazonaws.com/Twitter_Social_Icon_Circle_Color.png", align: 'center') %></a>&nbsp;
    <% elsif @user.twitter_id.present? %>
      <a href="<%= 'https://twitter.com/intent/follow?screen_name=' + @user.twitter_id %>"><%= image_tag("/assets/Twitter_Social_Icon_Circle_Color.png", align: 'center') %></a>&nbsp;
    <% end %>
    <% if user_signed_in? && current_user != @user %>
      <% if current_user.following?(@user) %>
       <%= link_to '-リムーブ', relationship_path(id: @user.id), method: :delete, class: 'btn btn-sm btn-primary horizontal' %>&nbsp;
      <% else %>
        <%= link_to '+フォロー', relationships_path(follow: @user.id), method: :post, class: 'btn btn-sm btn-primary horizontal' %>&nbsp;
      <% end %>
    <% end %>
    <%= link_to 'フォロー', follow_user_path(id: @user.id), method: :get, class: 'horizontal sm tanka-link' %>
    <%= link_to @user.following_by_type_count('User'), follow_user_path(id: @user.id), method: :get, class: 'horizontal' %>
    <%= link_to 'フォロワー', follower_user_path(id: @user.id), method: :get, class: 'horizontal sm tanka-link' %>
    <%= link_to @user.followers_by_type_count('User'), follower_user_path(id: @user.id), method: :get, class: 'horizontal' %>
    <% if @user.profile.present? %>
      <p class="sm profile">
        <%= @user.profile %>
      </p>
    <% end %>
  </div>
  <% @posts.each do |post| %>
    <p>
      <%= link_to post.tanka, post_path(id: post.id), method: :get, class: 'tanka-link' %>&nbsp;
      <% if user_signed_in? && current_user.id != post.user_id %>
        <% if current_user.following?(post) %>
          <%= link_to '&#10024;'.html_safe, favorite_path(id: post.id), method: :delete, class: 'hearts' %><!--
        --><% else %><!--
          --><%= link_to '&#9825;'.html_safe, favorites_path(follow: post.id), method: :post, class: 'hearts' %><!--
        --><% end %><!--
      --><% else %><!--
        --><span class="hearts">&hearts;</span><!--
      --><% end %><!--
      --><span class="sm horizontal hearts"><%= post.followers_by_type_count('User') %></span>
    </p>
  <% end %>
  <%= paginate @posts %>
</div>
